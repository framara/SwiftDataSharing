name: SwiftDataSharing
options:
  bundleIdPrefix: com.example
  deploymentTarget:
    iOS: "17.0"
  xcodeVersion: "16.0"
  generateEmptyDirectories: true

settings:
  base:
    SWIFT_VERSION: "6.0"
    DEVELOPMENT_TEAM: "" # Set your team ID here (required for extensions)
    CODE_SIGN_STYLE: Automatic

targets:

  # ─────────────────────────────────────────────
  # Main App
  # ─────────────────────────────────────────────
  SwiftDataSharing:
    type: application
    platform: iOS
    sources:
      - path: Sources/App
      - path: Sources/Shared
    entitlements:
      path: App/Resources/App.entitlements
      properties:
        com.apple.security.application-groups:
          - group.com.example.swiftdatasharing
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.example.swiftdatasharing
        MARKETING_VERSION: "1.0.0"
        CURRENT_PROJECT_VERSION: "1"
        GENERATE_INFOPLIST_FILE: YES
        INFOPLIST_KEY_UILaunchScreen_Generation: YES
        INFOPLIST_KEY_UISupportedInterfaceOrientations_iPhone: "UIInterfaceOrientationPortrait UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight"
    dependencies:
      - target: ShareExtension
      - target: NotesWidget

  # ─────────────────────────────────────────────
  # Share Extension
  # ─────────────────────────────────────────────
  ShareExtension:
    type: app-extension
    platform: iOS
    sources:
      - path: Sources/ShareExtension
      - path: Sources/Shared
    entitlements:
      path: ShareExtension/Resources/ShareExtension.entitlements
      properties:
        com.apple.security.application-groups:
          - group.com.example.swiftdatasharing
    info:
      path: ShareExtension/Resources/Info.plist
      properties:
        CFBundleDisplayName: Save to App
        NSExtension:
          NSExtensionAttributes:
            NSExtensionActivationRule:
              NSExtensionActivationSupportsText: true
              NSExtensionActivationSupportsWebURLWithMaxCount: 1
              NSExtensionActivationSupportsWebPageWithMaxCount: 1
              NSExtensionActivationSupportsImageWithMaxCount: 10
              NSExtensionActivationSupportsFileWithMaxCount: 10
          NSExtensionPointIdentifier: com.apple.share-services
          NSExtensionPrincipalClass: $(PRODUCT_MODULE_NAME).ShareViewController
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.example.swiftdatasharing.ShareExtension
        MARKETING_VERSION: "1.0.0"
        CURRENT_PROJECT_VERSION: "1"

  # ─────────────────────────────────────────────
  # Widget Extension
  # ─────────────────────────────────────────────
  NotesWidget:
    type: app-extension
    platform: iOS
    sources:
      - path: Sources/Widget
      - path: Sources/Shared
    entitlements:
      path: Widget/Resources/Widget.entitlements
      properties:
        com.apple.security.application-groups:
          - group.com.example.swiftdatasharing
    info:
      path: Widget/Resources/Info.plist
      properties:
        CFBundleDisplayName: Notes Widget
        NSExtension:
          NSExtensionPointIdentifier: com.apple.widgetkit-extension
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.example.swiftdatasharing.NotesWidget
        MARKETING_VERSION: "1.0.0"
        CURRENT_PROJECT_VERSION: "1"
        LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/Frameworks @executable_path/../../Frameworks"
